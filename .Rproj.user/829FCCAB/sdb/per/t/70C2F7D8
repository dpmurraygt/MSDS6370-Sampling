{
    "collab_server" : "",
    "contents" : "---\ntitle: \"R Notebook\"\noutput:\n  html_document: \n    keep_md: yes\n  html_notebook: default\n---\n\n```{r}\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(readxl)\nlibrary(ggthemes)\n```\n\n#Exercise 1\n```{r}\nRectangle_Response<-read_xlsx(\"Data/MSDS6370-RectangleExercise.xlsx\")\n\nRectangle_Response <- Rectangle_Response %>% gather(\"Type\", \"Area\", 2:3)\n\n#Mean of Area\n#minimum area\n#maximum area\n#Number< Mean\n#Number >= Mean\n\n\nRectangle_Summary <- Rectangle_Response %>% group_by(Type) %>% \n  mutate(meanArea = mean(Area)) %>% \n  mutate(LessThan = ifelse(Area<meanArea, 1, 0), GreaterThan = ifelse(Area>=meanArea, 1, 0)) %>% group_by(Type) %>%\n  summarise(minArea = min(Area), maxArea=max(Area), meanArea = mean(Area), greaterThan = sum(GreaterThan), lessThan = sum(LessThan))\n\nRectangle_Summary\n\n```\n\n#Exercise 2\n```{r}\nRectangle2<-read_xlsx(\"Data/Lab1-Exercise2.xlsx\")\n\nRectangle2 <- Rectangle2 %>% gather(\"Type\", \"Area\", 2:3)\n\nRectangle_Summary <- Rectangle2 %>% group_by(Type) %>% \n  mutate(meanArea = mean(Area)) %>% \n  mutate(LessThan = ifelse(Area<meanArea, 1, 0), GreaterThan = ifelse(Area>=meanArea, 1, 0)) %>% group_by(Type) %>%\n  summarise(minArea = min(Area), maxArea=max(Area), meanArea = mean(Area), greaterThan = sum(GreaterThan), lessThan = sum(LessThan))\n\n\n```\n\n#Exercise 3\n```{r fig.width=8.5, fig.height=4}\nRectangle2 %>% filter(Type == \"Judgement Sample\") %>%\n  ggplot(aes(x=Area)) + geom_histogram() + theme_light() +ggtitle(\"Distribution Of Judgment Samples\")\n\n```\n#Exercise 4\n```{r fig.width=8.5, fig.height=4}\nRectangle2 %>% filter(Type == \"Simple Random Sample\") %>%\n  ggplot(aes(x=Area)) + geom_histogram() + theme_light()+ggtitle(\"Distribution Of Simple Random Samples\")\n\n```\n\n\n```{r fig.width=8.5, fig.height=4}\n#Mega sample of samples\n\nAllFarms<-read_xlsx(\"Data/RectangleDims.xlsx\")\n\nn_samples <- 10000\nsampleSize <-10\n\ni<-1\n\nSampleArea <- data.frame()\n\nwhile(i <= n_samples){\n  \n  thisSample<-100*mean(sample(AllFarms$area, sampleSize, replace=FALSE))\n  \n  \n  thisSample<- as.data.frame(thisSample)\n  thisSample$sampleNumber<-i\n  \n  SampleArea<-rbind(SampleArea, thisSample)\n  i<-i+1\n  \n}\n\nSampleArea %>% ggplot(aes(thisSample)) + geom_histogram() + theme_light() + ggtitle(\"Total Area Estimate - 10,000 Samples of Size 10\")\n\nmean(SampleArea$thisSample)\n```\n\n\n\n\n\n\n\n\n\n\n#Exercise 6\n```{r}\n#calculate minimum possible sample from size 10:\nMinimumSample <- AllFarms %>% \n  top_n(n=10, wt=-area) %>% group_by() %>% summarise(Mean=100*mean(area))\n\npnorm(1, mean(AllFarms$area),sd(AllFarms$area)/sqrt(10))\n\ntop_n(AllFarms, n=10, wt=area)\n\n```\n\n```{r}\n#calculate minimum possible sample from size 10:\nMaximumSample <- AllFarms %>%\n  arrange(area) %>% top_n(n=10, wt=area) %>% group_by() %>% summarise(Mean=100*mean(area))\n\nmean(AllFarms$area)\nsd(AllFarms$area)\n\npnorm(17, mean(AllFarms$area), 5.227/sqrt(10))\n```\n\n\n\n\n#Exercise 7\n```{r}\n#Can we construct a better Judgement Sample of 10?\nBestJudgement <- Rectangle2 %>% filter(Type == \"Judgement Sample\") %>% mutate(DiffFromActual = abs(738-Area)) %>%\n  arrange(Area) %>% top_n(10, -DiffFromActual) %>% group_by() %>% summarise(Mean=mean(Area))\n\nMinimumSample2 <- Rectangle2 %>% filter(Type == \"Judgement Sample\") %>%\n  arrange(Area) %>% top_n(10, -Area) %>% group_by() %>% summarise(Mean=mean(Area))\n\nMaximumSample2 <- Rectangle2 %>% filter(Type == \"Judgement Sample\") %>%\n  arrange(Area) %>% top_n(10, Area) %>% group_by() %>% summarise(Mean=mean(Area))\n\nsd(Rectangle2$Area[Rectangle2$Type==\"Judgement Sample\"])\nmean(Rectangle2$Area[Rectangle2$Type==\"Judgement Sample\"])\n\npnorm(844, mean=928.7, sd=163.5)\n\n```\n\n\n```{r}\n\nmean(SampleArea$thisSample)\nsd(SampleArea$thisSample)\n\npnorm(780, 739.94, 157.4037)\npnorm(1320, 739.94, 157.4037)\n\nsum(SampleArea$thisSample<=1320 & SampleArea$thisSample>=780)\n\n#How close are the judgement samples to the true mean?\nfilter(Rectangle_Response, Type==\"Judgement Sample\") %>% mutate(DiffToActual = abs(Area-100*mean(AllFarms$area))) %>% group_by() %>%\n  summarise(mean(DiffToActual), sd(DiffToActual))\n\n\nSampleArea %>% group_by() %>% mutate(DiffToActual = abs(thisSample - 100*mean(AllFarms$area))) %>% group_by() %>% summarise(mean(DiffToActual), sd(DiffToActual))\n\n```\n",
    "created" : 1516027510767.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "289303348",
    "id" : "70C2F7D8",
    "lastKnownWriteTime" : 1516028450,
    "last_content_update" : 1516028450533,
    "path" : "~/R Projects/MSDS6370 Sampling/Lab1.Rmd",
    "project_path" : "Lab1.Rmd",
    "properties" : {
        "chunk_output_type" : "inline",
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}